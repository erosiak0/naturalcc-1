[32m[2023-07-02 19:20:44]    INFO >> Load arguments in /home/erosiak/workspace/naturalcc_docker_build/naturalcc-1/run/summarization/transformer/config/python_wan/python.yml (train.py:290, cli_main())[0m
[32m[2023-07-02 19:20:44]    INFO >> {'criterion': 'be_cross_entropy', 'optimizer': 'torch_adam', 'lr_scheduler': 'fixed', 'tokenizer': None, 'bpe': None, 'common': {'no_progress_bar': 0, 'log_interval': 400, 'log_format': 'simple', 'tensorboard_logdir': '', 'memory_efficient_fp16': 1, 'fp16_no_flatten_grads': 1, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'empty_cache_freq': 0, 'task': 'be_summarization', 'seed': 1, 'cpu': 0, 'fp16': 0, 'fp16_opt_level': '01', 'bf16': 0, 'memory_efficient_bf16': 0, 'server_ip': '', 'server_port': ''}, 'dataset': {'num_workers': 3, 'skip_invalid_size_inputs_valid_test': 1, 'max_tokens': None, 'max_sentences': 64, 'required_batch_size_multiple': 8, 'dataset_impl': 'mmap', 'train_subset': 'train', 'valid_subset': 'dev', 'validate_interval': 1, 'fixed_validation_seed': None, 'disable_validation': 0, 'max_tokens_valid': None, 'max_sentences_valid': 512, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'distributed_training': {'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': None, 'distributed_port': -1, 'device_id': 0, 'pipeline_model_parallel': 0, 'distributed_no_spawn': 0, 'ddp_backend': 'c10d', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': None, 'find_unused_parameters': 0, 'fast_stat_sync': 0, 'broadcast_buffers': 0, 'global_sync_iter': 50, 'warmup_iterations': 500, 'local_rank': -1, 'block_momentum': 0.875, 'block_lr': 1, 'use_nbm': 0, 'average_sync': 0}, 'task': {'data': '/home/erosiak/data_naturalcc/python_wan/summarization/data-mmap', 'source_lang': 'code_tokens', 'target_lang': 'docstring_tokens', 'load_alignments': 0, 'left_pad_source': 0, 'left_pad_target': 0, 'max_source_positions': 400, 'max_target_positions': 32, 'upsample_primary': 1, 'truncate_source': 1, 'truncate_target': 1, 'append_eos_to_target': 1, 'eval_bleu': 1, 'eval_bleu_detok': 'space', 'eval_bleu_detok_args': None, 'eval_tokenized_bleu': 0, 'eval_bleu_remove_bpe': None, 'eval_bleu_args': None, 'eval_bleu_print_samples': 0}, 'model': {'arch': 'ncc_transformer', 'offset_positions_by_padding': 1, 'pooler_dropout': 0.2, 'activation_fn': 'relu', 'dropout': 0.2, 'attention_dropout': 0.2, 'activation_dropout': 0.2, 'relu_dropout': 0.2, 'encoder_positional_embeddings': 0, 'encoder_learned_pos': 1, 'encoder_max_relative_len': 0, 'encoder_embed_path': 0, 'encoder_embed_dim': 512, 'encoder_ffn_embed_dim': 2048, 'encoder_layers': 6, 'encoder_attention_heads': 8, 'encoder_normalize_before': 1, 'decoder_embed_path': '', 'decoder_positional_embeddings': 0, 'decoder_learned_pos': 1, 'decoder_max_relative_len': 0, 'decoder_embed_dim': 512, 'decoder_output_dim': 512, 'decoder_input_dim': 512, 'decoder_ffn_embed_dim': 2048, 'decoder_layers': 6, 'decoder_attention_heads': 8, 'decoder_normalize_before': 0, 'no_decoder_final_norm': 0, 'adaptive_softmax_cutoff': None, 'adaptive_softmax_dropout': 0.2, 'adaptive_softmax_factor': 0.0, 'share_decoder_input_output_embed': 1, 'decoder_out_embed_bias': 1, 'share_all_embeddings': 0, 'adaptive_input': 0, 'adaptive_input_factor': 0.0, 'adaptive_input_cutoff': None, 'tie_adaptive_weights': 0, 'tie_adaptive_proj': 0, 'no_cross_attention': 0, 'cross_self_attention': 0, 'layer_wise_attention': 0, 'encoder_layerdrop': 0.0, 'decoder_layerdrop': 0.0, 'encoder_layers_to_keep': None, 'decoder_layers_to_keep': None, 'layernorm_embedding': 0, 'no_scale_embedding': 1, 'encoder_dropout_in': 0.2, 'encoder_dropout_out': 0.2, 'decoder_dropout_in': 0.2, 'decoder_dropout_out': 0.2, 'max_source_positions': 400, 'max_target_positions': 32, 'multihead_attention_version': 'ncc', 'encoder_position_encoding_version': 'ncc_sinusoidal', 'decoder_position_encoding_version': 'ncc_sinusoidal'}, 'optimization': {'max_epoch': 200, 'max_update': 0, 'clip_norm': 5, 'update_freq': [1], 'lrs': [0.0001], 'min_lr': -1, 'use_bmuf': 0, 'force_anneal': None, 'warmup_updates': 0, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 1000000, 'sentence_avg': 0, 'adam': {'adam_betas': '(0.9, 0.999)', 'adam_eps': 1e-08, 'weight_decay': 0.0, 'use_old_adam': 0}, 'lr_shrink': 0.99}, 'checkpoint': {'restore_file': 'checkpoint_last.pt', 'reset_dataloader': None, 'reset_lr_scheduler': None, 'reset_meters': None, 'reset_optimizer': None, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 0, 'keep_interval_updates': 0, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': 0, 'no_epoch_checkpoints': 1, 'no_last_checkpoints': 0, 'no_save_optimizer_state': None, 'best_checkpoint_metric': 'bleu', 'maximize_best_checkpoint_metric': 1, 'patience': -1, 'save_dir': '/home/erosiak/data_naturalcc/python_wan/summarization/data-mmap/transformer/checkpoints', 'should_continue': 0, 'model_name_or_path': None, 'cache_dir': None, 'logging_steps': 500, 'save_steps': 2000, 'save_total_limit': 2, 'overwrite_output_dir': 0, 'overwrite_cache': 0}, 'eval': {'path': '/home/erosiak/data_naturalcc/python_wan/summarization/data-mmap/transformer/checkpoints/checkpoint_best.pt', 'remove_bpe': None, 'quiet': 1, 'results_path': None, 'model_overrides': '{}', 'max_sentences': 512, 'beam': 1, 'nbest': 1, 'max_len_a': 0, 'max_len_b': 30, 'min_len': 1, 'match_source_len': 0, 'no_early_stop': 1, 'unnormalized': 0, 'no_beamable_mm': 0, 'lenpen': 1, 'unkpen': 0, 'replace_unk': None, 'sacrebleu': 0, 'score_reference': 0, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': 0, 'sampling_topk': -1, 'sampling_topp': -1, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': 0, 'print_step': 0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': 0, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': 0, 'retain_iter_history': 0, 'decoding_format': None, 'nltk_bleu': 1, 'rouge': 1}} (train.py:292, cli_main())[0m
[32m[2023-07-02 19:20:44]    INFO >> single GPU training... (train.py:321, cli_main())[0m
Traceback (most recent call last):
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/erosiak/workspace/naturalcc_docker_build/naturalcc-1/run/summarization/transformer/train.py", line 326, in <module>
    cli_main()
  File "/home/erosiak/workspace/naturalcc_docker_build/naturalcc-1/run/summarization/transformer/train.py", line 322, in cli_main
    single_main(args)
  File "/home/erosiak/workspace/naturalcc_docker_build/naturalcc-1/run/summarization/transformer/train.py", line 203, in single_main
    task = tasks.setup_task(args)
  File "/home/erosiak/workspace/naturalcc_docker_build/naturalcc-1/ncc/tasks/__init__.py", line 15, in setup_task
    return TASK_REGISTRY[args['common']['task']].setup_task(args, **kwargs)
  File "/home/erosiak/workspace/naturalcc_docker_build/naturalcc-1/ncc/tasks/summarization/be_summarization.py", line 119, in setup_task
    src_dict = cls.load_dictionary(os.path.join(paths[0], '{}.dict.jsonl'.format(args['task']['source_lang'])))
  File "/home/erosiak/workspace/naturalcc_docker_build/naturalcc-1/ncc/tasks/ncc_task.py", line 53, in load_dictionary
    return Dictionary.load(filename)
  File "/home/erosiak/workspace/naturalcc_docker_build/naturalcc-1/ncc/data/dictionary.py", line 240, in load
    d.add_from_file(f)
  File "/home/erosiak/workspace/naturalcc_docker_build/naturalcc-1/ncc/data/dictionary.py", line 270, in add_from_file
    raise fnfe
  File "/home/erosiak/workspace/naturalcc_docker_build/naturalcc-1/ncc/data/dictionary.py", line 267, in add_from_file
    with file_io.open(f, "r") as fd:
  File "/home/erosiak/workspace/naturalcc_docker_build/naturalcc-1/ncc/utils/file_ops/file_io.py", line 22, in open
    return builtins.open(file, mode=mode, **kwargs)
FileNotFoundError: [Errno 2] No such file or directory: '/home/erosiak/data_naturalcc/python_wan/summarization/data-mmap/code_tokens.dict.jsonl'
